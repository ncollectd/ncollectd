.\" SPDX-License-Identifier: GPL-2.0-only
.Dd @NCOLLECTD_DATE@
.Dt NCOLLECTD-TCPCONNS 5
.Os ncollectd @NCOLLECTD_VERSION@
.Sh NAME
.Nm ncollectd-tcpconns
.Nd Documentation of ncollectd's tcpconns plugin
.Sh SYNOPSIS
.Bd -literal -compact
\fBload-plugin\fP tcpconns
\fBplugin\fP tcpconns {
    \fBcounter\fP \fIcounter-name\fP {
        \fBlocal-ip\fP \fIaddress\fP|\fIaddress\fP/\fIprefix\fP
        \fBlocal-port\fP \fIport\fP[,\fIport\fP][,\fIstart-end\fP]...
        \fBremote-ip\fP \fIaddress\fP|\fIaddress\fP/\fIprefix\fP
        \fBremote-port\fP \fIport\fP[,\fIport\fP][,\fIstart-end\fP]...
    }
}
.Ed
.Sh DESCRIPTION
The \fBtcpconns\fP plugin counts the number of currently established TCP
connections based on the local ip, local port, remote ip and/or remote port.

By default count all system connections grouped by tcp state.

You can define multiple \fIcounters\fP blocks to fine-tune the connections
you are interested in:
.Bl -tag -width Ds
.It \fBcounter\fP \fIcounter-name\fP
.Bl -tag -width Ds
.It \fBlocal-ip\fP \fIaddress\fP|\fIaddress\fP/\fIprefix\fP
Filter tcp connections for this local ip or network (with the CIDR notation).
.It \fBlocal-port\fP \fIport\fP[,\fIport\fP][,\fIstart-end\fP]...
Filter tcp connections for this local port, a range of ports
(two ports separated by a dash) or list of ports (separated by a comma).
.It \fBremote-ip\fP \fIaddress\fP|\fIaddress\fP/\fIprefix\fP
Filter tcp connections for this remote ip or network (with the CIDR notation).
.It \fBremote-port\fP \fIport\fP[,\fIport\fP][,\fIstart-end\fP]...
Filter tcp connections for this repote port, a range of ports
(two ports separated by a dash) or list of ports (separated by a comma).
.El
.El
.Sh "SEE ALSO"
.Xr ncollectd 1 ,
.Xr ncollectd.conf 5
